# åŠ¨æ€ç‰ˆæœ¬æ³¨å…¥ä½¿ç”¨æŒ‡å—

## ğŸ¯ åŠŸèƒ½ä»‹ç»

GoAgent ç°åœ¨æ”¯æŒåœ¨ç¼–è¯‘æ—¶åŠ¨æ€æ³¨å…¥ç‰ˆæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š

- **ç‰ˆæœ¬å·** - å¯è‡ªå®šä¹‰æˆ–è‡ªåŠ¨ç”Ÿæˆ
- **æ„å»ºæ—¶é—´** - è‡ªåŠ¨è·å–ç¼–è¯‘æ—¶é—´
- **Gitæäº¤** - è‡ªåŠ¨è·å–å½“å‰Gitæäº¤å“ˆå¸Œ
- **Gitåˆ†æ”¯** - è‡ªåŠ¨è·å–å½“å‰Gitåˆ†æ”¯
- **Goç‰ˆæœ¬** - è‡ªåŠ¨è·å–ç¼–è¯‘æ—¶çš„Goç‰ˆæœ¬

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. ä½¿ç”¨å¢å¼ºæ„å»ºè„šæœ¬

**Windows ç”¨æˆ·ï¼š**
```cmd
# è‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬å·
.\scripts\build-version.bat windows

# æŒ‡å®šç‰ˆæœ¬å·
.\scripts\build-version.bat windows "1.0.0"

# æ„å»ºæ‰€æœ‰å¹³å°
.\scripts\build-version.bat all "1.0.0"
```

**Linux ç”¨æˆ·ï¼š**
```bash
# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x scripts/build-version.sh

# è‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬å·
./scripts/build-version.sh linux

# æŒ‡å®šç‰ˆæœ¬å·
./scripts/build-version.sh linux "1.0.0"

# æ„å»ºæ‰€æœ‰å¹³å°
./scripts/build-version.sh all "1.0.0"
```

### 2. æ‰‹åŠ¨æ„å»º

```bash
# åŸºæœ¬ç‰ˆæœ¬æ³¨å…¥
go build -ldflags="-s -w -X main.Version=1.0.0" -o GoAgent.exe .

# å®Œæ•´ç‰ˆæœ¬ä¿¡æ¯æ³¨å…¥
go build -ldflags="-s -w \
  -X main.Version=1.0.0 \
  -X main.BuildTime=$(date '+%Y-%m-%d_%H:%M') \
  -X main.GitCommit=$(git rev-parse --short HEAD) \
  -X main.GitBranch=$(git rev-parse --abbrev-ref HEAD) \
  -X main.GoVersion=$(go version | awk '{print $3}')" \
  -o GoAgent.exe .
```

## ğŸ“‹ ç‰ˆæœ¬ä¿¡æ¯æ˜¾ç¤º

### æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯
```bash
# æ˜¾ç¤ºå®Œæ•´ç‰ˆæœ¬ä¿¡æ¯
.\GoAgent.exe version

# æˆ–ä½¿ç”¨ç®€å†™
.\GoAgent.exe -v
.\GoAgent.exe --version
```

### è¿è¡Œæ—¶ç‰ˆæœ¬æ˜¾ç¤º
ç¨‹åºæ­£å¸¸è¿è¡Œæ—¶ä¹Ÿä¼šåœ¨å¯åŠ¨ä¿¡æ¯ä¸­æ˜¾ç¤ºç‰ˆæœ¬ï¼š

```
========================================
æœåŠ¡ï¼šæ˜Ÿå°˜ä»£ç†(DHAgent)
æè¿°ï¼šæ˜Ÿå°˜ï¼Œåˆ†å¸ƒå¼èµ„æºè°ƒåº¦ï¼Œéƒ¨ç½²äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿æ¥æœåŠ¡ç«¯ï¼Œæ”¯æŒèŠ‚ç‚¹ç›‘æ§ã€è¿œç¨‹å‘å¸ƒã€‚
çŠ¶æ€ï¼šWindows æœåŠ¡è¿è¡Œä¸­
è·¯å¾„ï¼šF:\Project\GoAgent\GoAgent.exe
========================================
DHAgent       ç‰ˆæœ¬ï¼š1.2.0   æ„å»ºæ—¶é—´ï¼š2025-08-31_22:06
Gitæäº¤ï¼š9b4e425   åˆ†æ”¯ï¼šmain   Goç‰ˆæœ¬ï¼šgo1.25.0
```

## ğŸš€ è‡ªåŠ¨ç‰ˆæœ¬å·ç”Ÿæˆè§„åˆ™

å¦‚æœä¸æŒ‡å®šç‰ˆæœ¬å·ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆï¼š

**æ ¼å¼ï¼š** `ä¸»ç‰ˆæœ¬.å¹´ä»½.æœˆæ—¥.æ—¶åˆ†-auto`

**ç¤ºä¾‹ï¼š** `4.13.202508.2206-auto`

- `4.13` - ä¸»ç‰ˆæœ¬å·
- `202508` - 2025å¹´08æœˆ  
- `2206` - 22ç‚¹06åˆ†
- `auto` - è‡ªåŠ¨ç”Ÿæˆæ ‡è¯†

## ğŸ” ç‰ˆæœ¬å˜é‡è¯´æ˜

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| `main.AppName` | åº”ç”¨åç§° | `DHAgent` |
| `main.Version` | ç‰ˆæœ¬å· | `1.2.0` |
| `main.BuildTime` | æ„å»ºæ—¶é—´ | `2025-08-31_22:06` |
| `main.GitCommit` | Gitæäº¤å“ˆå¸Œ | `9b4e425` |
| `main.GitBranch` | Gitåˆ†æ”¯ | `main` |
| `main.GoVersion` | Goç‰ˆæœ¬ | `go1.25.0` |

## ğŸ“ CI/CD é›†æˆ

åœ¨æŒç»­é›†æˆç¯å¢ƒä¸­ä½¿ç”¨ï¼š

```yaml
# GitHub Actions ç¤ºä¾‹
- name: Build with version
  run: |
    VERSION=${GITHUB_REF#refs/tags/}
    ./scripts/build-version.sh all "$VERSION"
```

```bash
# Jenkins ç¤ºä¾‹
./scripts/build-version.sh all "${BUILD_NUMBER}"
```

## ğŸ”— ç›¸å…³å‘½ä»¤

- `GoAgent.exe help` - æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
- `GoAgent.exe version` - æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯
- `GoAgent.exe status` - æŸ¥çœ‹æœåŠ¡çŠ¶æ€

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Gitä¿¡æ¯è·å–** - éœ€è¦åœ¨Gitä»“åº“ä¸­æ„å»ºæ‰èƒ½è·å–Gitä¿¡æ¯
2. **æ„å»ºç¯å¢ƒ** - ç¡®ä¿æ„å»ºç¯å¢ƒæœ‰`git`ã€`date`ç­‰å‘½ä»¤
3. **æ—¶é—´æ ¼å¼** - æ„å»ºæ—¶é—´ä½¿ç”¨ç®€åŒ–æ ¼å¼é¿å…ç‰¹æ®Šå­—ç¬¦é—®é¢˜
4. **ç‰ˆæœ¬è§„èŒƒ** - å»ºè®®éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼ˆå¦‚ v1.2.3ï¼‰
